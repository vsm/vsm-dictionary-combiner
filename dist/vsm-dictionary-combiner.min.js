var VsmDictionaryCombiner=function(r){var t={};function e(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=r,e.c=t,e.d=function(r,t,n){e.o(r,t)||Object.defineProperty(r,t,{enumerable:!0,get:n})},e.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,t){if(1&t&&(r=e(r)),8&t)return r;if(4&t&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&t&&"string"!=typeof r)for(var i in r)e.d(n,i,function(t){return r[t]}.bind(null,i));return n},e.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,"a",t),t},e.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},e.p="",e(e.s=0)}([function(r,t,e){var n=e(1);r.exports=class extends n{constructor(r){var t=r||{};super(t),this.dictionaries=t.dictionaries||[],this.errorIfAllErrors="boolean"!=typeof t.errorIfAllErrors||t.errorIfAllErrors}getDictInfos(r,t){var e=this,n=this.dictionaries.length;if(0===n)return t(null,{items:[]});var i=new Map,s=[],o=function(o){if("function"!=typeof o.getDictInfos)return--n,"continue";i.set(o,{}),o.getDictInfos(r,(r,a)=>{if(r&&!e.errorIfAllErrors)return t(r);if(s.push(r),i.set(o,a),--n<=0){var c=[];for(var u of i.values())void 0!==u&&(c=c.concat(u.items));s.every(r=>null!==r)?t({errors:s}):t(null,{items:c})}})};for(var a of this.dictionaries)o(a)}getEntries(r,t){var e=this,n=this.dictionaries.length;if(0===n)return t(null,{items:[]});var i=new Map,s=[],o=function(o){if("function"!=typeof o.getEntries)return--n,"continue";i.set(o,{}),o.getEntries(r,(r,a)=>{if(r&&!e.errorIfAllErrors)return t(r);if(s.push(r),i.set(o,a),--n<=0){var c=[];for(var u of i.values())void 0!==u&&(c=c.concat(u.items));s.every(r=>null!==r)?t({errors:s}):t(null,{items:c})}})};for(var a of this.dictionaries)o(a)}getEntryMatchesForString(r,t,e){var n=this;if(!r||""===r.trim())return e(null,{items:[]});var i=this.dictionaries.length;if(0===i)return e(null,{items:[]});var s=new Map,o=[],a=function(a){if("function"!=typeof a.getEntryMatchesForString)return--i,"continue";s.set(a,{}),a.getEntryMatchesForString(r,t,(r,t)=>{if(r&&!n.errorIfAllErrors)return e(r);if(o.push(r),s.set(a,t),--i<=0){var c=[];for(var u of s.values())void 0!==u&&(c=c.concat(u.items));o.every(r=>null!==r)?e({errors:o}):e(null,{items:c})}})};for(var c of this.dictionaries)a(c)}}},function(r,t,e){const{prepTerms:n,prepEntry:i,zPropPrune:s}=e(2),{deepClone:o,strcmp:a,callAsync:c}=e(3),u=e(4),f="to implement by a subclass";r.exports=class{constructor(r){var t=r||{};this.numberMatchConfig=!1===t.numberMatchConfig||"object"==typeof t.numberMatchConfig?t.numberMatchConfig:{dictID:"00",conceptIDPrefix:"00:"},this.extraDictInfos=this.numberMatchConfig?[{id:this.numberMatchConfig.dictID,name:"Numbers"}]:[],this.matchDescrs={number:"number",refTerm:"referring term"},this.fixedTermsCache={},this.defaultRefTerms=["it","that","them","these","they","this"]}loadFixedTerms(r,t,e){if(!r.length)return c(e,null);var n=o(t);n.filter||(n.filter={}),n.filter.id=r.map(r=>r.id),n.page=1,n.perPage=r.length,n.getAllResults=!0,this.getEntries(n,(t,n)=>{if(t)return e(t);r.forEach(r=>{var t=n.items.find(t=>t.id==r.id);if(t){var e=t.terms.findIndex(t=>t.str==r.str);-1==e&&(e=0);var i=this._idtToFTCacheKey(r.id,r.str||"");this.fixedTermsCache[i]=this._entryToMatch(t,e,"F")}}),e(null)})}_idtToFTCacheKey(r,t=""){return`${r}\n${t}`}_entryToMatch(r,t,e){return Object.assign({},r,r.terms[t],{type:e})}getMatchesForString(r,t,e){if((t.page||1)>1)return this.getEntryMatchesForString(r,t,e);var n=[],i=[],s=0,o=this;function a(a,c,u){n[a]=c,i[a]=u,2==++s&&function(){var s=n.find(r=>r);if(s)return e(s);var a=i[0],c=a.items;i[1].items.length&&c.unshift(o.refTermToMatch(i[1].items[0]));c=o._addFixedMatchesForString(r,c,t),a.items=o._addNumberMatchForString(r,c),e(null,a)}()}this.getEntryMatchesForString(r,t,(r,t)=>a(0,r,t)),this.getRefTerms({filter:{str:[r]}},(r,t)=>a(1,r,t))}_addFixedMatchesForString(r,t,e){var n=this._getFixedMatchesForString(r,e);if(n.length){var i=!(!t[0]||"R"!=t[0].type)&&t.shift();t=n.concat(t),i&&t.unshift(i),t=t.reduce((r,e,n)=>{return n==t.findIndex(r=>e.id==r.id&&e.str==r.str)&&r.push(e),r},[])}return t}_addNumberMatchForString(r,t){var e=this._getNumberMatchForString(r);if(e){var n=t.findIndex(r=>r.id==e.id);n>=0&&(e=t.splice(n,1)[0]),t.unshift(e),e.type="N",e.descr||(e.descr=this.matchDescrs.number)}return t}_getFixedMatchesForString(r,t){if(!t.idts)return[];var e=[],n=t.idts;return r=r.toLowerCase(),e=(e=n.reduce((t,e)=>{var n=this._idtToFTCacheKey(e.id,e.str||""),i=this.fixedTermsCache[n];if(!i)return t;var s=i.str.toLowerCase().startsWith(r)?"F":i.str.toLowerCase().includes(r)?"G":0;return s&&t.push(Object.assign(o(i),{type:s})),t},e)).sort((r,t)=>a(r.type,t.type)||a(r.str,t.str)||a(r.dictID,t.dictID)||r.id-t.id),s(e,t.z)}_getNumberMatchForString(r){if(!this.numberMatchConfig||!r)return!1;var t=u(r);return!1!==t&&{id:this.numberMatchConfig.conceptIDPrefix+t,dictID:this.numberMatchConfig.dictID,str:r,descr:this.matchDescrs.number,type:"N"}}refTermToMatch(r){return{id:"",dictID:"",str:r,descr:this.matchDescrs.refTerm,type:"R"}}getExtraDictInfos(){return this.extraDictInfos}static prepTerms(...r){return n(...r)}static prepEntry(...r){return i(...r)}static zPropPrune(...r){return s(...r)}addDictInfos(r,t){t(f)}addEntries(r,t){t(f)}addRefTerms(r,t){t(f)}updateDictInfos(r,t){t(f)}updateEntries(r,t){t(f)}deleteDictInfos(r,t){t(f)}deleteEntries(r,t){t(f)}deleteRefTerms(r,t){t(f)}getDictInfos(r,t){t(f)}getEntries(r,t){t(f)}getRefTerms(r,t){this._getRefTermsFromSortedArray(this.defaultRefTerms,r,t)}_getRefTermsFromSortedArray(r,t,e){t.filter&&t.filter.str&&(r=r.filter(r=>t.filter.str.includes(r)));var n=Math.max(1,t.page||1),i=Math.max(1,t.perPage||r.length),s=(n-1)*i;r=r.slice(s,s+i),c(e,null,{items:r})}}},function(r,t){function e(r){return(r=r.map(r=>(function(r){var t={str:r.str};return void 0!==r.style&&(t.style=r.style),void 0!==r.descr&&(t.descr=r.descr),t})(r))).reduce((r,t)=>{for(var e=0;e<r.length;e++)if(r[e].str===t.str){r[e]=t;break}return e==r.length&&r.push(t),r},[])}r.exports={prepTerms:e,prepEntry:function(r){var t={id:r.id,dictID:r.dictID,terms:e(r.terms)};void 0!==r.descr&&(t.descr=r.descr);void 0!==r.z&&(t.z=r.z);return t},zPropPrune:function(r,t=!0){return!0===t?r:r.map(r=>{if(void 0===r.z)return r;var e=Object.assign({},r,{z:{}});return t.forEach(t=>{void 0!==r.z[t]&&(e.z[t]=r.z[t])}),Object.keys(e.z).length||delete e.z,e})}}},function(r,t){r.exports={deepClone:function(r){return JSON.parse(JSON.stringify(r))},strcmp:function(r,t,e=!1){e||(r=r.toLowerCase(),t=t.toLowerCase());return r<t?-1:r>t?1:0},callAsync:function(r,...t){setTimeout(()=>r(...t),0)}}},function(r,t){r.exports=function(r){var t=r.match(e);if(null===t)return!1;var i="-"===t[1]?"-":"",s=t[2],o=t[3]||"0";"+"===o[0]&&(o=o.substr(1));var a=s.indexOf(".");a<0&&(a=s.length);var c=s.replace(/\./g,"");if(!c||c.length<s.length-1)return!1;var u=c.search(/[1-9]/);if(u<0)return"0e+0";o=n(o,(a-1-u).toString()),(s=c.substr(u).replace(/0+$/,"")).length>1&&(s=s[0]+"."+s.substr(1));return i+s+"e"+("-"!=o[0]?"+":"")+o.toString()},r.exports.addBigInts=n;var e=/^([+-])?([0-9.]+)(?:[e|E]([+-]?[0-9]+))?$/;function n(r,t){var e="-"===r[0]?1:0,n="-"===t[0]?1:0;e&&(r=r.substr(1)),n&&(t=t.substr(1));var i=e===n;if(r=r.replace(/^0+/,""),t=t.replace(/^0+/,""),""===r&&""===t||!i&&r===t)return"0";if(!i&&(r.length<t.length||r.length===t.length&&r<t)){var s=r;r=t,t=s,e=n}r=r.split(""),t=t.split("");for(var o=0,a="";r.length||t.length||o;)a=((o=~~r.pop()+(i?~~t.pop()+o:-~~t.pop()-o))+10)%10+a,o=i?o>9:o<0;return(e?"-":"")+a.replace(/^0+/,"")}}]);